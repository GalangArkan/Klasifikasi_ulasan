{% extends "base.html" %}
{% block content %}

<div class="container mt-4 fade-in">
  <div class="text-center mb-4">
    <h2 class="fw-bold text-danger">
      <i class="fa-solid fa-brain"></i> Analisis Ulasan
    </h2>
    <p class="text-muted">
      Masukkan teks ulasan di bawah, lalu pilih kategori produk. Sistem akan menganalisis apakah ulasan ini 
      <strong>asli</strong> atau <strong>palsu</strong> menggunakan tiga model Machine Learning.
    </p>
  </div>  <div class="card shadow-lg border-0 p-4 mx-auto card-animate" style="max-width: 800px; border-radius: 20px;">
    <form id="analyzeForm" method="post">  <!-- Kategori Produk -->
  <div class="mb-4">
    <label for="category" class="form-label fw-semibold text-secondary">
      <i class="fa-solid fa-tags"></i> Pilih Kategori Produk
    </label>
    <select id="category" name="category" class="form-select shadow-sm category-select" required>
      <option value="" disabled selected>Pilih salah satu kategori...</option>
      <option value="Elektronik">Elektronik</option>
      <option value="Fashion">Fashion</option>
      <option value="Kecantikan">Kecantikan</option>
      <option value="Makanan">Makanan</option>
      <option value="Kesehatan">Kesehatan</option>
    </select>
  </div>

  <!-- Input Ulasan -->
  <div class="mb-3">
    <label for="review" class="form-label fw-semibold text-secondary">
      <i class="fa-solid fa-pen-to-square"></i> Masukkan Teks Ulasan
    </label>
    <textarea id="review" name="review" rows="5" class="form-control shadow-sm"
              placeholder="Contoh: Barangnya jelek, penjual tidak responsif..." required></textarea>
  </div>

  <!-- Pilihan Model -->
  <div class="mb-4">
    <label class="form-label fw-semibold text-secondary">
      <i class="fa-solid fa-gears"></i> Pilih Model Analisis
    </label>
    <div class="d-flex flex-wrap gap-3 mt-2 justify-content-center">
      <label class="btn btn-outline-danger shadow-sm model-btn">
        <input type="radio" name="model" value="all" checked> Semua Model
      </label>
      <label class="btn btn-outline-primary shadow-sm model-btn">
        <input type="radio" name="model" value="naive_bayes"> Naive Bayes
      </label>
      <label class="btn btn-outline-success shadow-sm model-btn">
        <input type="radio" name="model" value="logreg"> Logistic Regression
      </label>
      <label class="btn btn-outline-warning shadow-sm model-btn">
        <input type="radio" name="model" value="dt"> Decision Tree
      </label>
    </div>
  </div>

  <!-- Tombol Analisis -->
  <div class="text-center">
    <button type="submit" id="analyzeBtn" class="btn btn-warning btn-lg shadow-sm hover-glow">
      <i class="fa-solid fa-magnifying-glass-chart"></i> Analisis Sekarang
    </button>
  </div>
</form>

<!-- Loading Animation -->
<div id="loading" class="text-center mt-4" style="display:none;">
  <div class="spinner-border text-warning" style="width: 3rem; height: 3rem;" role="status"></div>
  <p class="mt-3 fw-semibold text-muted" id="loading-text">Sedang menganalisis ulasan kamu...</p>
</div>

  </div>
</div><!-- ðŸŽ¨ CSS Animasi dan Tampilan --><style>
  .fade-in { animation: fadeIn 0.7s ease-in-out; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px);} to { opacity: 1; transform: translateY(0);} }

  .card-animate {
    animation: popUp 0.5s ease-in-out;
  }
  @keyframes popUp {
    0% { opacity: 0; transform: scale(0.95); }
    100% { opacity: 1; transform: scale(1); }
  }

  textarea.form-control {
    resize: none; font-size: 15px; border-radius: 12px; border: 1px solid #ddd; transition: 0.3s;
  }
  textarea.form-control:focus {
    border-color: #ff6600; box-shadow: 0 0 8px rgba(255, 102, 0, 0.4);
  }

  .category-select {
    border-radius: 12px;
    border: 1px solid #ddd;
    transition: all 0.3s ease;
  }
  .category-select:focus {
    border-color: #ff6600;
    box-shadow: 0 0 8px rgba(255, 102, 0, 0.4);
    transform: scale(1.02);
  }

  .hover-glow:hover {
    box-shadow: 0 0 15px rgba(255, 165, 0, 0.7);
    transform: translateY(-2px);
    transition: 0.3s ease-in-out;
  }

  .model-btn input[type="radio"] {
    display: none;
  }
  .model-btn:hover {
    transform: scale(1.05);
    transition: 0.2s;
  }
</style><!-- ðŸŒ€ Script Loading Animation --><script>
  const form = document.getElementById('analyzeForm');
  const loading = document.getElementById('loading');
  const loadingText = document.getElementById('loading-text');
  const button = document.getElementById('analyzeBtn');

  function animateDots() {
    let dots = 0;
    return setInterval(() => {
      dots = (dots + 1) % 4;
      loadingText.textContent = "Sedang menganalisis ulasan kamu" + ".".repeat(dots);
    }, 500);
  }

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    form.style.display = 'none';
    loading.style.display = 'block';
    button.disabled = true;

    const dotAnim = animateDots();
    setTimeout(() => {
      clearInterval(dotAnim);
      form.submit();
    }, 2500);
  });
</script>{% endblock %}